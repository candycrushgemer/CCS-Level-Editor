<!DOCTYPE html>
<html lang="en" style="scroll-behavior: smooth;">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CCGApps | Home</title>
  <link rel="stylesheet" href="/ccgemer-home-stylesheet.css">
  <link rel="preconnect" href="https://rsms.me/">
  <link rel="stylesheet" href="https://rsms.me/inter/inter.css">
  <link rel="shortcut icon" href="icon.png" type="image/x-icon"><!-- Add GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
  <link rel="stylesheet" href="landing_ccs_css.css">
  <script src="../../level-editor/app/instant-navigation.js"></script>
</head>

<body>
  <top-app-bar>
    <ul>
      <li id="ccgappsLogo" style="font-weight: 800; display: flex; align-items: center; gap: 1px; position: relative;">
        <img src="/CCGAppsGifLogo.gif" alt="CCGApps" style="width: 20px; height: 20px; border-radius: 50%; transform: scale(1.8); opacity: 0; position: absolute; left: 10px;"> 
        <span class="ccgapps-text" style="margin-left: 5px;">CCGApps</span>
      </li>
    </ul>
    <ul class="top-app-bar-btns">
      <li onclick="window.location.href = '/'">Home</li>
      <li onclick="window.location.href = '/#tools'">Tools</li>
    </ul>
  </top-app-bar>
  <main>
    <div class="header_grd_blue"></div>
    <main-title>
      <div style="margin-top: 100px;" class="header_big_text">
        <img src="/landingTex/blue.png" class="absolute floating texblue">
        <img src="/landingTex/bomb.png" class="absolute floating bomb" width="300px">
        <img src="/landingTex/frog.png" class="absolute floating frog">
        <div class="left">
          <h1 class="big_header bubblegum_bliss blue_color">Download CCS Level Replacer</h1>
          <span>Download the desktop app to replace your levels!<br>Just a few steps left and you are ready!</span>
          <button normal type="button" style="width: fit-content;" onclick="downloadEditor()">Download now!</button>
          <span style="font-size: smaller; opacity: 0.7; display: none;" class="download-helper">If the download hasn't started, <a id="directdownloadtry" href="#download">click here</a> to try again, or go to <a href="https://drive.usercontent.google.com/download?id=19k_aMc3_ylMPqdr6-qOkPwpqOVQhtVe8&export=download&authuser=0">the direct link</a>.</span>
          <span style="font-size: smaller; opacity: 0.7;"><br>*Requires Windows 10 or later.</span>
        </div>
        <div class="right">
          <img src="/home_assets/replacer.png" width="300px" style="min-width: 300px; aspect-ratio: 1/1 !important;" class="level-editor-logo">
        </div>
      </div>
    </main-title>
    
    <main-title>
      <h1 class="normal-title"
        style="margin-top: 100px; text-align: center; font-size: 70px; width: 60%; line-height: 1.5;align-content: center;">Requirements</h1>
        <ul>
          <li>Your computer must run Windows 10 64-bit or later.</li>
          <li>Your computer must have at least 100 MB of storage.</li>
          <li>Your computer must have at least 4 GB RAM.</li>
          <li>A minimum of an Intel i3 processor or an equivalent AMD processor is required.</li>
        </ul>
    </main-title>

    <main-title class="blue_grd" style="position: relative;">
      <h1 class="normal-title blue_color"
        style="margin-top: 100px; text-align: center; font-size: 50px; width: 70%; line-height: 1.5;align-content: center;">...maybe it's time to design level first!</h1> 
        <span>Go to the editor now and create a new level and start replacing!</span><br><br>
        <button normal onclick="window.location.href = '/level-editor/editor/'">Go to it</button><br>
    </main-title>
  <footer class="ccgemer-footer">
    
  <div class="footer_header_grd_blue"></div>
    <footer-column>
      <p style="font-weight: 800;">CCGApps</p>
      <p>Follow us</p>
      <footer-follow-bar>
        <footer-follow-button class="youtube-btn" onclick="window.open('https://youtube.com/@candycrushgemer')"><img src="/youtube.svg" alt=""
            draggable="false"></footer-follow-button>
        <footer-follow-button class="facebook-btn" onclick="window.open('https://www.facebook.com/candycrushgemer/')"><img src="/facebook.svg" alt=""
            draggable="false"></footer-follow-button>
      </footer-follow-bar>
      <p>Contact us</p>
      <a href="mailto:contact.ccgccs@gmail.com" class="email-link"><sf-icon
          style="font-size: x-large;">􀍕</sf-icon>contact.ccgccs@gmail.com</a>
    </footer-column>
    <footer-column>
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/#tools">Tools</a></li>
        <li><a href="#support">Support</a></li>
      </ul>
    </footer-column>
    <footer-column>
      <ul>
        <li><a href="https://ccgapps.web.app/level-editor/editor/document.html?doc=legal_stuff">Legal</a></li>
        <li><a href="https://ccgapps.web.app/level-editor/editor/document.html?doc=legal_stuff">Terms of Service</a></li>
        <li><a href="https://ccgapps.web.app/level-editor/editor/document.html?doc=legal_stuff">Terms of Use</a></li>
      </ul>
    </footer-column>
  </footer>

  <script>
    const API_KEY = 'AIzaSyD0hOfL1MC7VChWG03NCm-zXZMsZmkgYMg';
    const CHANNEL_ID = 'UCT02PeLywRKsBBG3lYQ5cxg';
    const PLAYLIST_ID = 'PLrxi_0VCJYCe9M-h3PW0ekLCKK1u2qzIU';

    fetch(`https://www.googleapis.com/youtube/v3/channels?part=snippet,statistics&id=${CHANNEL_ID}&key=${API_KEY}`)
      .then(response => response.json())
      .then(data => {
        const channel = data.items[0];
        const avatar = channel.snippet.thumbnails.default.url;
        const title = channel.snippet.title;
        const username = channel.snippet.customUrl ? `${channel.snippet.customUrl}` : '';
        const subs = channel.statistics.subscriberCount;

        const html = `
          <channel-info-content class="channel-info" style="display: flex; gap: 15px;">
            <img src="${avatar}" alt="Avatar" draggable="false">
            <channel-info-text>
              <channel-name class="channel-name"><h1>${title}</h1></channel-name>
              <channel-username class="channel-username">${username}</channel-username><br>
              <channel-subscribers-count class="channel-subs">${Number(subs).toLocaleString()} subscribers</channel-subscribers-count>
            </channel-info-text>
          </channel-info-content>
          <sf-icon style="display: none;"></sf-icon>
        `;

        document.getElementById('channelCard').innerHTML = html;
      })
      .catch(err => {
        console.error('Failed to load channel data', err);
        document.getElementById('channelCard').textContent = 'Failed to load channel info';
      });

    // Load playlist videos
    fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=100&playlistId=${PLAYLIST_ID}&key=${API_KEY}`)
      .then(response => response.json())
      .then(data => {
        const container = document.getElementById('playlistContainer');
        container.innerHTML = '';

        data.items.forEach(item => {
          const videoId = item.snippet.resourceId.videoId;
          const title = item.snippet.title;
          const channelTitle = item.snippet.videoOwnerChannelTitle;
          const thumbnail = item.snippet.thumbnails.medium.url;

          const videoCard = document.createElement('youtube-video');
          videoCard.onclick = () => window.open(`https://www.youtube.com/watch?v=${videoId}`, '_blank');
          videoCard.className = 'video-card';
          videoCard.target = '_blank';
          videoCard.innerHTML = `
              <img src="${thumbnail}" alt="${title}">
              <youtube-video-preview-info class="video-info">
                <video-title class="video-title"><h2>${title}</h2></video-title><br>
                <video-channel class="video-channel">${channelTitle}</video-channel>
              </youtube-video-preview-info>  
            `;

          container.appendChild(videoCard);
        });
      })
      .catch(err => {
        console.error('Error loading playlist', err);
        document.getElementById('playlistContainer').textContent = 'Failed to load playlist.';
      });
  </script>
  <script>
    // Download editor function using Google Drive API
    async function downloadEditor() {
      const fileId = '1-qKT576HA194Qz0dnnLDFbhuNyuSDGqL';
      const apiKey = 'AIzaSyBtUTZyi3X_5j0DQesTKNN30xyqL9OthdU';
      
      try {
        // Show loading state
        const button = event.target;
        const originalText = button.textContent;
        button.textContent = 'Downloading...';
        button.disabled = true;
        
        // Show the download helper text
        const helperSpan = document.querySelector('.download-helper');
        if (helperSpan) {
          helperSpan.style.display = 'block';
        }
        
        // First, get file metadata to check accessibility and get filename
        const metadataUrl = `https://www.googleapis.com/drive/v3/files/${fileId}?key=${apiKey}&fields=name,size,mimeType`;
        const metadataResponse = await fetch(metadataUrl);
        
        if (!metadataResponse.ok) {
          throw new Error(`API Error: ${metadataResponse.status}`);
        }
        
        const metadata = await metadataResponse.json();
        console.log('File metadata:', metadata);
        
        // Method 1: Try to fetch the file data using API and create blob download
        const downloadUrl = `https://www.googleapis.com/drive/v3/files/${fileId}?alt=media&key=${apiKey}`;
        
        const response = await fetch(downloadUrl);
        
        if (response.ok) {
          // Convert response to blob
          const blob = await response.blob();
          
          // Create download link with blob URL
          const blobUrl = window.URL.createObjectURL(blob);
          const link = document.createElement('a');
          link.href = blobUrl;
          link.download = metadata.name || 'CCSEditor1.9Setup.exe';
          link.style.display = 'none';
          document.body.appendChild(link);
          
          // Use setTimeout to ensure the click works properly on first try
          setTimeout(() => {
            link.click();
            console.log('Download click triggered');
            
            // Clean up after a short delay
            setTimeout(() => {
              if (document.body.contains(link)) {
                document.body.removeChild(link);
              }
              window.URL.revokeObjectURL(blobUrl);
            }, 100);
          }, 100);
          
          console.log('Download initiated successfully via API');
          
        } else {
          throw new Error(`Download failed: ${response.status}`);
        }
        
        // Reset button
        button.textContent = originalText;
        button.disabled = false;
        
      } catch (error) {
        console.error('API download failed:', error);
        
        // Reset button
        const button = event.target;
        button.textContent = 'Download now!';
        button.disabled = false;
        
        // Fallback to direct URL methods
        console.log('Trying fallback download methods...');
        const directUrls = [
          `https://drive.google.com/uc?export=download&id=${fileId}&confirm=t`,
          `https://drive.usercontent.google.com/download?id=${fileId}&export=download&confirm=t`
        ];
        
        for (const url of directUrls) {
          try {
            const link = document.createElement('a');
            link.href = url;
            link.download = 'CCSEditor1.9Setup.exe';
            link.style.display = 'none';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            console.log('Fallback download initiated');
            return;
          } catch (fallbackError) {
            console.log('Fallback method failed:', fallbackError);
          }
        }
        
        // Final fallback - open sharing link
        window.open(`https://drive.google.com/file/d/${fileId}/view?usp=sharing`, '_blank');
      }
    }
    
    // Add event listener for direct download try link
    document.addEventListener('DOMContentLoaded', function() {
      const directDownloadLink = document.getElementById('directdownloadtry');
      if (directDownloadLink) {
        directDownloadLink.addEventListener('click', function(e) {
          e.preventDefault();
          downloadEditor();
        });
      }
    });
  </script>
  <script>
    // Initialize GSAP ScrollTrigger
    gsap.registerPlugin(ScrollTrigger);

    // CCGApps logo hover animation
    const ccgappsLogo = document.getElementById('ccgappsLogo');
    const ccgappsText = ccgappsLogo.querySelector('.ccgapps-text');
    const ccgappsImg = ccgappsLogo.querySelector('img');

    // Set initial state
    gsap.set(ccgappsText, { x: 0 });
    gsap.set(ccgappsImg, { opacity: 0, x: -10 });

    // Create hover animation timeline
    const logoHoverTl = gsap.timeline({ paused: true });
    
    logoHoverTl
      .to(ccgappsText, {
        x: 15,
        duration: 0.3,
        ease: "power2.out"
      })
      .to(ccgappsImg, {
        opacity: 1,
        x: 0,
        duration: 0.3,
        ease: "power2.out"
      }, "-=0.2");

    // Add hover listeners
    ccgappsLogo.addEventListener('mouseenter', () => {
      logoHoverTl.play();
      // Reset gif by reloading it
      ccgappsImg.src = ccgappsImg.src;
    });

    ccgappsLogo.addEventListener('mouseleave', () => {
      logoHoverTl.reverse();
    });
  </script>
</body>

</html>